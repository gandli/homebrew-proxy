# ðŸ”§ å¼€å‘è„šæœ¬å·¥å…·é›†

æœ¬ç›®å½•åŒ…å«äº† `homebrew-proxy` é¡¹ç›®çš„å¼€å‘å’Œç»´æŠ¤è„šæœ¬å·¥å…·ã€‚

## ðŸ“‹ è„šæœ¬åˆ—è¡¨

### ðŸ› ï¸ dev-tools.sh - ç»Ÿä¸€å¼€å‘å·¥å…·å…¥å£

**ä¸»è¦è„šæœ¬**ï¼Œæä¾›æ‰€æœ‰å¼€å‘ä»»åŠ¡çš„ç»Ÿä¸€å…¥å£ç‚¹ã€‚

```bash
# åŸºæœ¬ç”¨æ³•
./dev-tools.sh [command] [options]

# å¸¸ç”¨å‘½ä»¤
./dev-tools.sh validate --all     # éªŒè¯æ‰€æœ‰ Cask æ–‡ä»¶
./dev-tools.sh fix --all          # ä¿®å¤æ‰€æœ‰ Cask æ–‡ä»¶
./dev-tools.sh test --all         # è¿è¡Œæ‰€æœ‰æµ‹è¯•
./dev-tools.sh setup              # è®¾ç½®å¼€å‘çŽ¯å¢ƒ
./dev-tools.sh help               # æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
```

**åŠŸèƒ½ç‰¹æ€§ï¼š**

- âœ… ç»Ÿä¸€çš„å‘½ä»¤è¡Œç•Œé¢
- âœ… å½©è‰²è¾“å‡ºå’Œå‹å¥½çš„ç”¨æˆ·ä½“éªŒ
- âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†
- âœ… æ”¯æŒè°ƒè¯•å’Œè¯¦ç»†æ¨¡å¼
- âœ… å¹²è¿è¡Œæ¨¡å¼æ”¯æŒ

### âœ… validate-casks.sh - Cask æ–‡ä»¶éªŒè¯

éªŒè¯ Cask æ–‡ä»¶æ˜¯å¦ç¬¦åˆé¡¹ç›®æ ‡å‡†å’Œ Homebrew è§„èŒƒã€‚

```bash
# éªŒè¯æ‰€æœ‰æ–‡ä»¶
./validate-casks.sh --all

# éªŒè¯å•ä¸ªæ–‡ä»¶
./validate-casks.sh Casks/clash-nyanpasu.rb
```

**æ£€æŸ¥é¡¹ç›®ï¼š**

- âœ… å¿…éœ€å­—æ®µå®Œæ•´æ€§ï¼ˆversion, sha256, url, name, desc, homepageï¼‰
- âœ… Livecheck é…ç½®
- âœ… å¤šæž¶æž„æ”¯æŒ
- âœ… ä»£ç æ ¼å¼å’Œç¼©è¿›
- âœ… æ¸…ç†é…ç½®ï¼ˆzapï¼‰
- âœ… HTTPS URL ä½¿ç”¨
- âœ… Homebrew audit æ£€æŸ¥

### ðŸ”§ fix-casks.sh - Cask æ–‡ä»¶ä¿®å¤

è‡ªåŠ¨ä¿®å¤ Cask æ–‡ä»¶ä¸­çš„å¸¸è§æ ¼å¼é—®é¢˜ã€‚

```bash
# ä¿®å¤æ‰€æœ‰æ–‡ä»¶
./fix-casks.sh --all

# ä¿®å¤å•ä¸ªæ–‡ä»¶
./fix-casks.sh Casks/clash-nyanpasu.rb

# å¹²è¿è¡Œæ¨¡å¼ï¼ˆä»…æ˜¾ç¤ºéœ€è¦ä¿®å¤çš„å†…å®¹ï¼‰
DRY_RUN=1 ./fix-casks.sh --all
```

**ä¿®å¤åŠŸèƒ½ï¼š**

- âœ… ç¼©è¿›æ ‡å‡†åŒ–ï¼ˆ2 ç©ºæ ¼ï¼‰
- âœ… Livecheck å—æ ¼å¼åŒ–
- âœ… ä»£ç ç»“æž„ä¼˜åŒ–
- âœ… è¯­æ³•é”™è¯¯ä¿®å¤

## ðŸš€ å¿«é€Ÿå¼€å§‹

### 1. è®¾ç½®å¼€å‘çŽ¯å¢ƒ

```bash
# ä¸€é”®è®¾ç½®å¼€å‘çŽ¯å¢ƒ
./dev-tools.sh setup

# æˆ–åˆ†æ­¥è®¾ç½®
./dev-tools.sh setup --deps    # æ£€æŸ¥ä¾èµ–
./dev-tools.sh setup --hooks   # è®¾ç½® Git hooks
./dev-tools.sh setup --config  # é…ç½®å¼€å‘çŽ¯å¢ƒ
```

### 2. æ—¥å¸¸å¼€å‘å·¥ä½œæµ

```bash
# 1. éªŒè¯çŽ°æœ‰ Cask æ–‡ä»¶
./dev-tools.sh validate --all

# 2. ä¿®å¤å‘çŽ°çš„é—®é¢˜
./dev-tools.sh fix --all

# 3. å†æ¬¡éªŒè¯ç¡®ä¿ä¿®å¤æˆåŠŸ
./dev-tools.sh validate --all

# 4. è¿è¡Œæµ‹è¯•
./dev-tools.sh test --all
```

### 3. æ·»åŠ æ–° Cask æ–‡ä»¶

```bash
# 1. åˆ›å»ºæ–°çš„ Cask æ–‡ä»¶
vim Casks/new-app.rb

# 2. éªŒè¯æ–°æ–‡ä»¶
./dev-tools.sh validate --file Casks/new-app.rb

# 3. ä¿®å¤æ ¼å¼é—®é¢˜ï¼ˆå¦‚æžœæœ‰ï¼‰
./dev-tools.sh fix --file Casks/new-app.rb

# 4. æœ€ç»ˆéªŒè¯
./dev-tools.sh validate --file Casks/new-app.rb
```

## ðŸ” è„šæœ¬è¾“å‡ºè¯´æ˜Ž

### æ—¥å¿—çº§åˆ«

- ðŸ”µ **ä¿¡æ¯ (â„¹ï¸)**ï¼šä¸€èˆ¬ä¿¡æ¯å’ŒçŠ¶æ€æ›´æ–°
- ðŸŸ¢ **æˆåŠŸ (âœ…)**ï¼šæ“ä½œæˆåŠŸå®Œæˆ
- ðŸŸ¡ **è­¦å‘Š (âš ï¸)**ï¼šéœ€è¦æ³¨æ„ä½†ä¸å½±å“åŠŸèƒ½çš„é—®é¢˜
- ðŸ”´ **é”™è¯¯ (âŒ)**ï¼šéœ€è¦ä¿®å¤çš„ä¸¥é‡é—®é¢˜
- ðŸŸ£ **æ­¥éª¤ (ðŸ”§)**ï¼šå½“å‰æ‰§è¡Œçš„æ“ä½œæ­¥éª¤

### éªŒè¯ç»“æžœè§£è¯»

```bash
=== éªŒè¯æŠ¥å‘Š ===
â„¹ï¸  æ€» Cask æ•°é‡: 10
âœ… å®Œå…¨é€šè¿‡: 3
âš ï¸  æœ‰è­¦å‘Šçš„ Cask: 7 (æ€»è­¦å‘Šæ•°: 15)
âŒ éªŒè¯å¤±è´¥: 0
â„¹ï¸  æˆåŠŸçŽ‡: 100%
```

- **å®Œå…¨é€šè¿‡**ï¼šæ²¡æœ‰ä»»ä½•é—®é¢˜çš„ Cask æ–‡ä»¶
- **æœ‰è­¦å‘Š**ï¼šåŠŸèƒ½æ­£å¸¸ä½†æœ‰æ”¹è¿›ç©ºé—´çš„æ–‡ä»¶
- **éªŒè¯å¤±è´¥**ï¼šæœ‰ä¸¥é‡é—®é¢˜éœ€è¦ä¿®å¤çš„æ–‡ä»¶
- **æˆåŠŸçŽ‡**ï¼š(å®Œå…¨é€šè¿‡ + æœ‰è­¦å‘Š) / æ€»æ•° Ã— 100%

## ðŸ› ï¸ é«˜çº§ç”¨æ³•

### çŽ¯å¢ƒå˜é‡

```bash
# å¯ç”¨è°ƒè¯•æ¨¡å¼
DEBUG=1 ./dev-tools.sh validate --all

# å¯ç”¨è¯¦ç»†è¾“å‡º
VERBOSE=1 ./dev-tools.sh fix --all

# å¹²è¿è¡Œæ¨¡å¼ï¼ˆä»…æ˜¾ç¤ºæ“ä½œï¼Œä¸å®žé™…æ‰§è¡Œï¼‰
DRY_RUN=1 ./dev-tools.sh fix --all
```

### é›†æˆåˆ° CI/CD

```yaml
# GitHub Actions ç¤ºä¾‹
- name: éªŒè¯ Cask æ–‡ä»¶
  run: |
    chmod +x .github/scripts/dev-tools.sh
    .github/scripts/dev-tools.sh validate --all

- name: ä¿®å¤æ ¼å¼é—®é¢˜
  run: |
    .github/scripts/dev-tools.sh fix --all

- name: è¿è¡Œæµ‹è¯•
  run: |
    .github/scripts/dev-tools.sh test --all
```

### Git Hooks é›†æˆ

è„šæœ¬ä¼šè‡ªåŠ¨è®¾ç½® pre-commit hookï¼Œåœ¨æ¯æ¬¡æäº¤å‰éªŒè¯ Cask æ–‡ä»¶ï¼š

```bash
# è®¾ç½® Git hooks
./dev-tools.sh setup --hooks

# çŽ°åœ¨æ¯æ¬¡ git commit éƒ½ä¼šè‡ªåŠ¨è¿è¡ŒéªŒè¯
git commit -m "Add new cask"
# ðŸ” è¿è¡Œ pre-commit æ£€æŸ¥...
# âœ… æ‰€æœ‰ Cask æ–‡ä»¶éªŒè¯é€šè¿‡ï¼
```

## ðŸ“Š é¡¹ç›®ç»Ÿè®¡

```bash
# æŸ¥çœ‹é¡¹ç›®ç»Ÿè®¡ä¿¡æ¯
./dev-tools.sh stats

# æŸ¥çœ‹ Cask æ–‡ä»¶ç»Ÿè®¡
./dev-tools.sh stats --casks

# æŸ¥çœ‹æäº¤ç»Ÿè®¡
./dev-tools.sh stats --commits

# æŸ¥çœ‹è´¡çŒ®è€…ç»Ÿè®¡
./dev-tools.sh stats --contributors
```

## ðŸ”§ æ•…éšœæŽ’é™¤

### å¸¸è§é—®é¢˜

#### 1. è„šæœ¬æƒé™é—®é¢˜

```bash
# è§£å†³æ–¹æ¡ˆï¼šæ·»åŠ æ‰§è¡Œæƒé™
chmod +x .github/scripts/*.sh
```

#### 2. Homebrew æœªå®‰è£…

```bash
# è§£å†³æ–¹æ¡ˆï¼šå®‰è£… Homebrew
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
```

#### 3. éªŒè¯å¤±è´¥ä½†ä¸çŸ¥é“å…·ä½“é—®é¢˜

```bash
# è§£å†³æ–¹æ¡ˆï¼šå¯ç”¨è¯¦ç»†æ¨¡å¼
VERBOSE=1 ./dev-tools.sh validate --file Casks/problematic-cask.rb
```

#### 4. ä¿®å¤è„šæœ¬æ²¡æœ‰æ•ˆæžœ

```bash
# è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥æ–‡ä»¶æƒé™å’Œå¤‡ä»½
ls -la Casks/
# ç¡®ä¿æ–‡ä»¶å¯å†™ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰ .bak å¤‡ä»½æ–‡ä»¶
```

### èŽ·å–å¸®åŠ©

```bash
# æŸ¥çœ‹è¯¦ç»†å¸®åŠ©
./dev-tools.sh help

# æŸ¥çœ‹ç‰¹å®šå‘½ä»¤çš„å¸®åŠ©
./dev-tools.sh validate --help
```

## ðŸ¤ è´¡çŒ®

å¦‚æžœä½ æƒ³æ”¹è¿›è¿™äº›è„šæœ¬ï¼š

1. ðŸ´ Fork é¡¹ç›®
2. ðŸŒŸ åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. âœ… æµ‹è¯•ä½ çš„æ›´æ”¹
4. ðŸ“ æ›´æ–°ç›¸å…³æ–‡æ¡£
5. ðŸš€ æäº¤ Pull Request

### è„šæœ¬å¼€å‘è§„èŒƒ

- âœ… ä½¿ç”¨ `set -euo pipefail` ç¡®ä¿é”™è¯¯å¤„ç†
- âœ… æä¾›å½©è‰²è¾“å‡ºå’Œå‹å¥½çš„ç”¨æˆ·ä½“éªŒ
- âœ… åŒ…å«è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œå»ºè®®
- âœ… æ”¯æŒè°ƒè¯•å’Œè¯¦ç»†æ¨¡å¼
- âœ… æ·»åŠ é€‚å½“çš„æ³¨é‡Šå’Œæ–‡æ¡£
- âœ… éµå¾ªé¡¹ç›®çš„ä»£ç é£Žæ ¼

---

> ðŸ’¡ **æç¤º**ï¼šå»ºè®®å°† `dev-tools.sh` æ·»åŠ åˆ°ä½ çš„ shell åˆ«åä¸­ï¼Œä»¥ä¾¿å¿«é€Ÿè®¿é—®ï¼š
>
> ```bash
> # æ·»åŠ åˆ° ~/.bashrc æˆ– ~/.zshrc
> alias hb-dev='./github/scripts/dev-tools.sh'
> ```
